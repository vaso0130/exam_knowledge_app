# 心智圖渲染器功能說明

## 概述
新的心智圖渲染器是一個獨立的模組，提供完整的 Mermaid 心智圖生成和渲染功能。

## 主要功能

### 1. 圖形化渲染
- **自動渲染**: 將 Mermaid 程式碼自動轉換為視覺化圖表
- **線上服務**: 使用 Mermaid.ink 服務進行圖片渲染
- **滾動支援**: 支援大型心智圖的滾動瀏覽
- **自適應縮放**: 自動調整圖片大小以適應顯示區域

### 2. 雙重顯示模式
- **圖形化標籤頁**: 顯示渲染後的心智圖圖片
- **程式碼標籤頁**: 顯示原始 Mermaid 程式碼，方便編輯和檢查

### 3. 豐富的操作功能
- **📋 複製代碼**: 將 Mermaid 程式碼複製到剪貼簿
- **🌐 在線預覽**: 在瀏覽器中開啟 Mermaid Live Editor 進行編輯
- **🔄 重新渲染**: 重新載入和渲染當前心智圖
- **💾 儲存圖片**: 將心智圖儲存為 PNG 或 SVG 格式

### 4. 智能快取系統
- **資料庫快取**: 生成的心智圖程式碼會自動儲存到資料庫
- **快速載入**: 已生成的心智圖會直接從快取載入，無需重複 AI 計算
- **強制重新生成**: 支援忽略快取，重新生成心智圖

### 5. 容錯機制
- **降級顯示**: 當圖片渲染失敗時，會回退到文字模式
- **錯誤處理**: 清晰的錯誤訊息和狀態指示
- **超時保護**: 網路請求有超時保護機制

## 使用方式

### 基本使用
1. 在文件列表中選擇一個文件
2. 點擊「🧠 AI心智圖」按鈕
3. 系統會自動切換到心智圖標籤頁並開始渲染

### 進階功能
- **查看原始碼**: 切換到「📝 程式碼」標籤查看 Mermaid 程式碼
- **複製使用**: 使用「📋 複製代碼」按鈕複製程式碼到其他工具
- **線上編輯**: 使用「🌐 在線預覽」在瀏覽器中進一步編輯心智圖
- **儲存備份**: 使用「💾 儲存圖片」將心智圖保存為圖片檔案

## 技術特點

### 1. 模組化設計
- 獨立於主界面的渲染模組
- 可重複使用的組件架構
- 清晰的職責分離

### 2. 非同步處理
- 背景執行緒處理 AI 生成
- 不阻塞使用者介面
- 即時狀態更新

### 3. 多格式支援
- PNG 圖片輸出（適合插入文件）
- SVG 向量圖輸出（適合高解析度顯示）
- 原始 Mermaid 程式碼（適合進一步編輯）

### 4. 優化性能
- 智能快取減少 API 呼叫
- 圖片預載和縮放
- 記憶體效率管理

## 未來擴展

可能的擴展方向：
- 支援更多圖表類型（流程圖、時序圖等）
- 本地 Mermaid 渲染引擎
- 自定義主題和樣式
- 批量匯出功能
- 圖表編輯功能

---

**注意**: 心智圖渲染功能需要網路連接以使用 Mermaid.ink 線上服務。
